import { Callout } from 'nextra/components';

# Pulling and Pushing Items Between Branches

You can add an item from one branch to another by pulling or pushing them. When that is done, it's the same item on both branches
where the ID of the item remains the same, meaning that this will not result in direct merge conflicts. 
- [**Pushing an item**](#pushing-items-to-another-branch): Adding an item from a branch that a user is currently on, to another branch. 
- [**Pulling an item**](#pulling-items-from-another-branch): Adding an item to a branch that the user is currently on, from another branch.

## Pushing items to another branch

Pushing events, properties and property bundles from the branch that a user is currently on, to another branch is possible from the [Tracking Plan Changes view](/data-design/branches#review-branch-changes). 

In the tacking plan changes view, each changed item is displayed individually. 
For the items that can be pushed to another branch (events, properties and property groups), there is a button in the top right corner for pushing the item.

![Pressing push button](/images/pulling-pushing-items/press-push-button.png)

Clicking the button opens a modal prompting selection of a destination branch and a review of the changes.
A branch must be selected first so Avo can accurately display how the changes will be applied—this may vary depending on whether the item already exists on the selected branch.

<center><img
  src="/docs/images/pulling-pushing-items/empty-push-modal.png"
  width="60%"
  alt="Empty review modal"
/></center>

When the destination branch is selected you can [review the changes](#reviewing-changes-to-be-pushed-or-pulled) and pick which [related changes](#property-changes-related-to-event) should be included when you push.  

Then you can navigate to your destination branch and use the item you pushed there.

![Empty review modal](/images/pulling-pushing-items/destination-branch.png)

## Pulling items from another branch

Pulling events, properties and property bundles from another branch to a branch that a user is currently on is now possible when searching for or creating those items:
- [When searching for items in context of another item details](#items-from-other-branches-surfaced-in-context–of–item-details) (for example adding a property to an event in event details)
- [When creating new events or properties](#items-with-similar-names-surfaced-during-creation) (for example by clicking the "+ New Event" button in the events view)
- [When searching for items in cmd+k or search bar](#items-from-other-branches-surfaced-in-global-search)

When an event from another branch is surfaced, you can select it and start the pulling process. You are prompted to review the changes that would be applied to the branch and are offered to exclude related changes that you don't want applied your branch.
Once you have reviewed the changes, click confirm and the event will be pulled to your branch and is available for reuse.

Below are more details about how items from other branches can be discovered:

### Items from other branches surfaced in context of item details 

The in-context search now surfaces items from other branches, in addition to items from the current branch and main.
For example when adding a property to an event in event details, properties from other branches are surfaced. Same with adding events to metrics or properties and adding properties as filter to a metric.

To do that, open the details view of the item you want to add to. In this example we're adding a property to an event.

<center><img
  src="/docs/images/pulling-pushing-items/event-details.png"
  width="60%"
  alt="Event details"
/></center>

Type in what you are looking for. Then Avo will surface properties from other branches, below the ones that are found on your branch.

<center><img
  src="/docs/images/pulling-pushing-items/event-details-found-on-other-branches.png"
  width="60%"
  alt="Searching for a property in event details"
/></center>

### Items with similar names surfaced during creation

When creating new events, properties and property bundles, the creation modal now surfaces similar items from other branches, in addition to what's already on your branch.
In this example we are creating a new event.

<center><img
  src="/docs/images/pulling-pushing-items/create-new-event-surface-similar.png"
  width="80%"
  alt="Create new event."
/></center>

When you click the name of an item from another branch, a preview of the item details from the source branch is opened in view mode.
There you can click "Pull to branch" to start the pulling process.

<center><img
  src="/docs/images/pulling-pushing-items/viewing-a-property-from-another-branch.png"
  width="60%"
  alt="Viewing a property from another branch."
/></center>

### Items from other branches surfaced in global search

When you search for tracking plan items in the global search, accessible in the side bar and via CMD+K, you now get results from other branches in addition to what's already on your branch.
In this example we're searching for a property.

<center><img
  src="/docs/images/pulling-pushing-items/pulling-in-global-search.png"
  width="80%"
  alt="Surfacing items from other branches in global search."
/></center>

When you click the name of an item from another branch, a preview of the item details from the source branch is opened in view mode.
There you can click "Pull to branch" to start the pulling process.

<center><img
  src="/docs/images/pulling-pushing-items/viewing-a-property-from-another-branch.png"
  width="60%"
  alt="Viewing a property from another branch."
/></center>

## Reviewing changes to be pushed or pulled

The items shown can be expanded to show the details of what will be added to the destination branch.
Avo determines which changes are necessary to push to the destination branch, leaving out changes that are unrelated to the selected item.
If the item you selected to push or is an event or a property bundle, any [related changes](#related-changes) are displayed below. 

Once you have reviewed your selection, you can click the Push or Pull to branch button, depending on your use case, and the changes will be applied to the destination branch.

<center><img
  src="/docs/images/pulling-pushing-items/collapsed-diff-modal.png"
  width="60%"
  alt="Empty review modal"
/></center>

## Related changes

When an event or property bundle is selected to push to another branch, the review modal will show a list of changes related to the event or property bundle.
The related changes can be sources, destinations, properties or property groups. 
By default, all related items and their changes are kept on the event or property bundle.

You can configure which related changes you want to keep:
- Any **new items** that were added to the selected item and **do not exist** on the destination branch
    - You can choose whether you include or exclude the new item.
- Any **existing items** that were added to the selected item and are **not on the item** on the destination branch
    - You can choose whether you include the item and it's changes, only include the item and not the changes or exclude the item.
- Any **existing items** on the selected item have been modified such that they are **different** on the destination branch
    - You can choose whether you include the item and it's changes or only include the item and not the changes.

<center><img
  src="/docs/images/pulling-pushing-items/include-exclude-options.png"
  width="60%"
  alt="Overview of the related changes options"
/></center>

## Merging branches where items have been pushed or pulled

When either the source or destination branch where items have been pushed or pulled are merged to main, you will be prompted to pull main on the branch where the items still remain.
As the ID of the items are the same, the items exist on main and there is no need to keep them specifically on the other branch. 
However, changes to these items between the branches will reconcile and the remaining diff will appear instead of the excluded item or changes.

## What can be pushed and pulled and from where?

Pushing and pulling is currently available for the following items:
- Events
- Properties
- Property bundles

Pushing is available for new and updated items from the following views:
- Tracking plan changes (button on each item that can be pushed)

Pulling is available for new items from the following areas:
- In context search in item details
  - Adding a property to an event in event details
  - Adding an event to a property in property details
  - Adding an event to a metric in metric details
  - Adding a property as an event filter in metric details
- Global search accessible via CMD+K and search input in the side bar
- Item creation modal
  - Creating a new event from the events view
  - Creating a new property from the property view
  - Creating a new property bundle from the property bundle view

## Pushing and pulling use cases

Pushing and pulling has several use cases. Some examples are below.

### Breaking down a large branch

It often happens when designing data, that a branch becomes quite big, containing a lot of event and property changes.
Then it's helpful to be able to break that branch into more manageable chunks, both to make review and implementation easier.

That is now possible by pushing items from the diff view to different branches. 

The original branch will retain everything that is pushed, so if the branch is to be split in two branches, it may be good to push to two separate branches.
Then the original branch has an overview of all changes and the child branches are focused on their purpose. 

### One team is ready to implement but not others

Commonly, Avo branches need to be implemented by more than one team. In many cases, teams are not able to implement in parallel, so it can be helpful to break the branches down for each team.

Now this is possible for platform teams. If for example the iOS team is ready to implement first, then items with the iOS source can be pushed to another branch.
When pushing, other sources can be excluded from events and/or [property presence per source](../avo-tracking-plan/properties#configuring-when-properties-are-required-or-optional) can be adjusted.
Then the iOS team can implement for only the iOS source, merge the branch and the changes will remain for the other sources on the original branch. 
When the next team is ready, their events can be pushed to another branch and so on.

### Reusing properties between open branches

Sometimes implementation of the branch blocks it to be merged to main and then the items that have been created on the branch can not be used on other branches.
Or sometimes different people are designing data for separate features in parallel and end up creating duplicate events on separate branches. 
That happens because previously, Avo didn't surface items from other branches. But now items from other branches are surfaced in search and can be pulled to your branch.